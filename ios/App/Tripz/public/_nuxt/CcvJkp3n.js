import{J as f,N as w,r as g,q as T,x as L,O as M,A as D,c as d,a as t,t as r,B,F as N,j as $,y as z,z as c,o as i}from"./7GWaBXbZ.js";import{u as C}from"./TCo5-zK6.js";const E={class:"min-h-screen bg-gray-100 dark:bg-gray-900 py-8"},F={class:"max-w-3xl mx-auto px-4"},R={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8"},S={key:0,class:"text-center py-4 text-gray-900 dark:text-gray-100"},j={key:1,class:"text-red-600 p-4 bg-red-100 rounded-lg"},A={key:2},q={class:"mb-4"},V={class:"text-gray-900 dark:text-white font-semibold"},I={class:"mb-4"},J={class:"text-gray-900 dark:text-white"},O={class:"mb-4"},U={class:"px-3 py-1 rounded bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200"},Z={class:"mb-4"},G={class:"px-3 py-1 rounded bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"},H={class:"mb-4"},K={class:"text-gray-900 dark:text-white"},P={class:"mb-4"},Q={class:"text-gray-900 dark:text-white"},W={key:0,class:"mb-4"},X={class:"bg-gray-50 dark:bg-gray-900 rounded p-4 overflow-x-auto"},Y={class:"min-w-full text-sm bg-white dark:bg-gray-800 rounded shadow overflow-hidden"},tt={class:"px-4 py-2 text-gray-900 dark:text-white"},et={class:"px-4 py-2 text-gray-900 dark:text-white"},at={class:"px-4 py-2 text-gray-900 dark:text-white"},nt={__name:"[id]",setup(st){f();const x=w(),k=C(),m=g(null);let o=null;const a=g(null),v=g(!0),p=g(null);T(()=>{var _,b;if(!((_=a.value)!=null&&_.created_at)||!((b=a.value)!=null&&b.end_time))return"N/A";const n=new Date(a.value.created_at),s=new Date(a.value.end_time)-n,l=Math.floor(s/(1e3*60*60)),u=Math.floor(s%(1e3*60*60)/(1e3*60)),y=Math.floor(s%(1e3*60)/1e3);return l>0?`${l}h ${u}m ${y}s`:u>0?`${u}m ${y}s`:`${y}s`});const h=async()=>{var e;if(!((e=a.value)!=null&&e.route)||!m.value)return;const n=z();c.accessToken=n.public.mapboxToken,o=new c.Map({container:m.value,style:"mapbox://styles/mapbox/streets-v12",center:a.value.route[0],zoom:12}),o.on("load",()=>{o.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:a.value.route}}}),o.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":4}}),new c.Marker({color:"#22c55e"}).setLngLat(a.value.route[0]).addTo(o),new c.Marker({color:"#ef4444"}).setLngLat(a.value.route[a.value.route.length-1]).addTo(o);const s=a.value.route.reduce((l,u)=>l.extend(u),new c.LngLatBounds(a.value.route[0],a.value.route[0]));o.fitBounds(s,{padding:50,maxZoom:15})})};return L(async()=>{var n;try{console.log("Fetching trip details for ID:",x.params.id);const{data:e,error:s}=await k.from("ridez_rides").select("*, ridez_routes(*)").eq("id",x.params.id).single();if(s)throw s;a.value={...e,route:((n=e.ridez_routes)==null?void 0:n.coordinates)||[]},await M(),h()}catch(e){console.error("Error fetching trip details:",e),p.value="Error loading trip details: "+e.message}finally{v.value=!1}}),D(()=>{o&&o.remove()}),(n,e)=>(i(),d("div",E,[t("div",F,[t("div",R,[e[8]||(e[8]=t("h1",{class:"text-2xl font-bold mb-4 text-gray-900 dark:text-white"},"Trip Details",-1)),v.value?(i(),d("div",S,"Loading trip details...")):p.value?(i(),d("div",j,r(p.value),1)):(i(),d("div",A,[t("div",q,[e[0]||(e[0]=t("span",{class:"block text-gray-700 dark:text-gray-300"},"Title:",-1)),t("span",V,r(a.value.title),1)]),t("div",I,[e[1]||(e[1]=t("span",{class:"block text-gray-700 dark:text-gray-300"},"Date:",-1)),t("span",J,r(n.formatDate(a.value.created_at)),1)]),t("div",O,[e[2]||(e[2]=t("span",{class:"block text-gray-700 dark:text-gray-300"},"Transport Type:",-1)),t("span",U,r(a.value.transport_type),1)]),t("div",Z,[e[3]||(e[3]=t("span",{class:"block text-gray-700 dark:text-gray-300"},"Transaction Type:",-1)),t("span",G,r(a.value.transaction_type),1)]),t("div",H,[e[4]||(e[4]=t("span",{class:"block text-gray-700 dark:text-gray-300"},"Amount:",-1)),t("span",K,"Â£"+r(a.value.amount),1)]),t("div",P,[e[5]||(e[5]=t("span",{class:"block text-gray-700 dark:text-gray-300"},"Notes:",-1)),t("span",Q,r(a.value.notes||"None"),1)]),a.value.route&&a.value.route.length?(i(),d("div",W,[e[7]||(e[7]=t("span",{class:"block text-gray-700 dark:text-gray-300 mb-2"},"Route:",-1)),t("div",X,[t("table",Y,[e[6]||(e[6]=t("thead",null,[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-gray-700 dark:text-gray-300"},"#"),t("th",{class:"px-4 py-2 text-left text-gray-700 dark:text-gray-300"},"Latitude"),t("th",{class:"px-4 py-2 text-left text-gray-700 dark:text-gray-300"},"Longitude")])],-1)),t("tbody",null,[(i(!0),d(N,null,$(a.value.route,(s,l)=>(i(),d("tr",{key:l},[t("td",tt,r(l+1),1),t("td",et,r(s.latitude),1),t("td",at,r(s.longitude),1)]))),128))])])])])):B("",!0)]))])])]))}};export{nt as default};
