import{m as G,r as n,P as I,x as q,s as L,c as i,a as e,L as v,B as j,n as _,t as b,E as U,k as u,C as g,F as O,j as R,p as z,o as d,G as A}from"./7GWaBXbZ.js";import"./Cjv9p6sY.js";import{u as T}from"./CatA3LoI.js";import{u as $}from"./TCo5-zK6.js";const W={class:"min-h-screen bg-gray-100 dark:bg-gray-900 py-8"},H={class:"max-w-2xl mx-auto px-4"},J={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6"},K={class:"flex justify-center space-x-4 mb-6"},Q={key:0,class:"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 rounded"},X=["disabled"],Y=["disabled"],Z={key:1,class:"space-y-6"},ee={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6"},te={class:"space-y-4"},re={class:"mt-1 text-gray-900 dark:text-white"},se={class:"mt-1 text-gray-900 dark:text-white"},ae={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 space-y-6"},le={class:"flex items-center space-x-4"},oe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ne={class:"mb-6"},ie={class:"flex gap-4 items-center"},ue=["value"],de={key:0},ge=["src"],me={key:1,class:"w-10 h-10 flex items-center justify-center border rounded-full bg-gray-500 text-xs text-white"},ce={class:"text-xs mt-1"},be={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6"},ye={class:"space-y-4"},xe={class:"flex items-center justify-between"},he={__name:"settings",setup(fe){const f=$(),l=G();z();const m=n(""),c=n(""),k=n(""),a=n(!1),o=n(""),y=n(!0),x=n("#00FF00"),p=n(.5);n(null);const{isDarkMode:w,fetchDarkMode:E,setDarkMode:C}=T(),h=I({my_icon:null}),D=[{label:"Blank",value:null},{label:"Car",value:"/assets/images/car-top-view-icon-11560.png"},{label:"Chick",value:"/assets/images/chick.png"},{label:"UFO",value:"/assets/images/ufo.png"},{label:"Taxi",value:"/assets/images/Taxi_Icon.png"},{label:"Uber",value:"/assets/images/uber.png"}],S=async()=>{if(!l.value){console.log("[DEBUG] No user loaded in loadSettings");return}try{console.log("[DEBUG] Loading settings for user:",l.value.id);const{data:r,error:t}=await f.from("ridez_settings").select("marker_color, marker_scale, my_icon").eq("user_id",l.value.id).single();if(console.log("[DEBUG] Supabase response:",{data:r,error:t}),t)throw t;r?(console.log("[DEBUG] Loaded marker settings:",r),x.value=r.marker_color||"#00FF00",p.value=r.marker_scale||.5,h.my_icon=r.my_icon??null):console.log("[DEBUG] No data found for user, using defaults")}catch(r){console.error("[DEBUG] Error loading settings:",r)}};q(()=>{S(),E()}),L(l,r=>{r&&(S(),E())});const M=async()=>{if(l.value)try{const{error:r}=await f.from("ridez_settings").upsert({user_id:l.value.id,marker_color:x.value,marker_scale:p.value,dark_mode:w.value,my_icon:h.my_icon},{onConflict:"user_id"});if(r)throw r;alert("Settings saved successfully!")}catch(r){console.error("Error saving settings:",r),alert("Error saving settings")}},B=async()=>{try{a.value=!0,o.value="";const{error:r}=await f.auth.signInWithPassword({email:m.value,password:c.value});if(r)throw r}catch(r){o.value=r.message||"Error signing in",console.error("Error signing in:",r)}finally{a.value=!1}},N=async()=>{try{a.value=!0,o.value="";const{data:r,error:t}=await f.auth.signUp({email:m.value,password:c.value,options:{data:{full_name:k.value}}});if(t)throw t;o.value="Registration successful! Please check your email to verify your account.",m.value="",c.value="",k.value="",y.value=!0}catch(r){o.value=r.message||"Error creating account",console.error("Error signing up:",r)}finally{a.value=!1}},P=async()=>{try{a.value=!0,o.value="";const{error:r}=await f.auth.signOut();if(r)throw r}catch(r){o.value=r.message||"Error signing out",console.error("Error signing out:",r)}finally{a.value=!1}},V=async()=>{await C(!w.value),await E()};return(r,t)=>(d(),i("div",W,[e("div",H,[t[26]||(t[26]=e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-8"},"Settings",-1)),v(l)?(d(),i("div",Z,[e("div",ee,[t[19]||(t[19]=e("h2",{class:"text-xl font-semibold mb-4 text-gray-900 dark:text-white"},"Profile",-1)),e("div",te,[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email",-1)),e("p",re,b(v(l).email),1)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),e("p",se,b(v(l).user_metadata.full_name||"Not set"),1)])])]),e("div",ae,[t[22]||(t[22]=e("h2",{class:"text-xl font-semibold mb-4 text-gray-900 dark:text-white"},"Marker Settings",-1)),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Marker Color ",-1)),e("div",le,[u(e("input",{type:"color","onUpdate:modelValue":t[7]||(t[7]=s=>x.value=s),class:"h-10 w-20 rounded cursor-pointer"},null,512),[[g,x.value]]),u(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=s=>x.value=s),class:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"#00FF00"},null,512),[[g,x.value]])])]),e("div",null,[e("label",oe," Marker Scale: "+b(p.value),1),u(e("input",{type:"range","onUpdate:modelValue":t[9]||(t[9]=s=>p.value=s),min:"0.1",max:"2",step:"0.1",class:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer"},null,512),[[g,p.value]])]),e("div",ne,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium mb-2 text-gray-900 dark:text-white"},"Car Icon",-1)),e("div",ie,[(d(),i(O,null,R(D,s=>e("label",{key:s.value||"blank",class:"flex flex-col items-center cursor-pointer text-gray-900 dark:text-white"},[u(e("input",{type:"radio",name:"my_icon",value:s.value,"onUpdate:modelValue":t[10]||(t[10]=F=>h.my_icon=F),class:"mb-2"},null,8,ue),[[A,h.my_icon]]),s.value?(d(),i("span",de,[e("img",{src:s.value,alt:"icon",class:"w-10 h-10 object-contain rounded-full border"},null,8,ge)])):(d(),i("span",me,"None")),e("span",ce,b(s.label),1)])),64))])]),e("button",{onClick:M,class:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"}," Save Settings ")]),e("div",be,[t[24]||(t[24]=e("h2",{class:"text-xl font-semibold mb-4 text-gray-900 dark:text-white"},"Preferences",-1)),e("div",ye,[e("div",xe,[t[23]||(t[23]=e("div",null,[e("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Dark Mode"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"Enable dark mode for the app")],-1)),e("button",{onClick:V,class:_(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none",v(w)?"bg-blue-600":"bg-gray-200"])},[e("span",{class:_(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",v(w)?"translate-x-5":"translate-x-0"])},null,2)],2)])])]),e("div",{class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6"},[t[25]||(t[25]=e("h2",{class:"text-xl font-semibold mb-4 text-gray-900 dark:text-white"},"Account Actions",-1)),e("button",{onClick:P,class:"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500"}," Sign Out ")])])):(d(),i("div",J,[e("div",K,[e("button",{onClick:t[0]||(t[0]=s=>y.value=!0),class:_(["px-4 py-2 rounded-md text-sm font-medium",y.value?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"])}," Login ",2),e("button",{onClick:t[1]||(t[1]=s=>y.value=!1),class:_(["px-4 py-2 rounded-md text-sm font-medium",y.value?"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white":"bg-blue-600 text-white"])}," Register ",2)]),o.value?(d(),i("div",Q,b(o.value),1)):j("",!0),y.value?(d(),i("form",{key:1,onSubmit:U(B,["prevent"]),class:"space-y-4"},[e("div",null,[t[11]||(t[11]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email",-1)),u(e("input",{type:"email",id:"email","onUpdate:modelValue":t[2]||(t[2]=s=>m.value=s),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,m.value]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Password",-1)),u(e("input",{type:"password",id:"password","onUpdate:modelValue":t[3]||(t[3]=s=>c.value=s),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,c.value]])]),e("button",{type:"submit",class:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:a.value},b(a.value?"Signing in...":"Sign In"),9,X)],32)):(d(),i("form",{key:2,onSubmit:U(N,["prevent"]),class:"space-y-4"},[e("div",null,[t[13]||(t[13]=e("label",{for:"fullName",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Full Name",-1)),u(e("input",{type:"text",id:"fullName","onUpdate:modelValue":t[4]||(t[4]=s=>k.value=s),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,k.value]])]),e("div",null,[t[14]||(t[14]=e("label",{for:"registerEmail",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email",-1)),u(e("input",{type:"email",id:"registerEmail","onUpdate:modelValue":t[5]||(t[5]=s=>m.value=s),required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,m.value]])]),e("div",null,[t[15]||(t[15]=e("label",{for:"registerPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Password",-1)),u(e("input",{type:"password",id:"registerPassword","onUpdate:modelValue":t[6]||(t[6]=s=>c.value=s),required:"",minlength:"6",class:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,c.value]]),t[16]||(t[16]=e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"Password must be at least 6 characters long",-1))]),e("button",{type:"submit",class:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:a.value},b(a.value?"Creating account...":"Create Account"),9,Y)],32))]))])]))}};export{he as default};
